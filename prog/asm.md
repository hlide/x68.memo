# アセンブリ言語

## ネタ

### アドレスをデータレジスタに入れる

基本形。X形式実行ファイルの場合はリロケート情報が添付され、R形式実行ファイルでは使用できない。
```
  move.l #label,d0
```

リロケート情報なしにしたいならPC相対アドレッシングを使う。ただし相対距離-$8000～$7fffの範囲に限られる。
```
  lea (label,pc),a0
  move.l a0,d0
```

アドレスレジスタを破壊したくない場合。
```
  pea (label,pc)
  move.l (sp)+,d0
```

スタックもアドレスレジスタも使わない。確かツイートで教えてもらった方法。
```
  move.l a0,d0
  lea (label,pc),a0
  exg d0,a0
```

直後のアドレス限定。ショートブランチなら4バイトで済み、上の方法より短い。  
届くなら`@f`にしてもよい。
```
@@:
  move.l (sp)+,d0
  ;...

  bsr.s @b
label:  ;データレジスタに入れたいアドレス(実行はされない)
```

直後から相対距離-$80～+$7fのアドレスにもできるが、6バイトになるので利点はない。
```
@@:
  moveq #offset,d0
  add.l (sp)+,d0
  ;...

  bsr.s @b
label:
```


----
goto [index](../README.md) / [プログラミング](./README.md)
